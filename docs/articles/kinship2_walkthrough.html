<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>kinship2_walkthrough • Assignment7</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="kinship2_walkthrough">
<meta property="og:description" content="Assignment7">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Assignment7</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/kinship2_walkthrough.html">kinship2_walkthrough</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>kinship2_walkthrough</h1>
            
      
      
      <div class="hidden name"><code>kinship2_walkthrough.Rmd</code></div>

    </div>

    
    
<div id="this-is-the-formal-vignette-for-the-kinship2-package" class="section level2">
<h2 class="hasAnchor">
<a href="#this-is-the-formal-vignette-for-the-kinship2-package" class="anchor"></a>This is the formal vignette for the kinship2 package</h2>
title: “Pedigree Examples” author: “Jason Sinnwell” date: ‘07 March, 2021’ output: rmarkdown::html_vignette: toc: yes toc_depth: 3 header-includes:

<p>vignette: | % % % —</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This document is a brief tutorial for the kinship2 package, with examples of creating pedigree objects and kinship matrices, and other pedigree utilities. If the kinship2 package is not loaded, we load it now.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=kinship2">kinship2</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="basic-usage" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h1>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h2>
<p>Two datasets are provided within the kinship2 package: + minnbreast: 17 families from a breast cancer study + sample.ped: two sample pedigrees, with 41 and 14 subjects</p>
<p>This vignette uses the two pedigrees in <sub>sample.ped</sub>. For more information on these datasets, see help(minnbreast) and help(sample.ped).</p>
</div>
<div id="pedigree" class="section level2">
<h2 class="hasAnchor">
<a href="#pedigree" class="anchor"></a>Pedigree</h2>
<p>First, we load <sub>sample.ped</sub> and look at some of the values in the dataset, and create a <em>pedigreeList</em> object using the <em>pedigree()</em> function. We use the required arguments <span class="math inline">\(id\)</span>, <span class="math inline">\(father\)</span>, <span class="math inline">\(mother\)</span>, and <span class="math inline">\(sex\)</span>. The <span class="math inline">\(famid\)</span> argument is required to make a {} object, but not for a single <em>pedigree}</em> object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(sample.ped)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">sample.ped[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">   ped  id father mother sex affected avail</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="dv">1</span>    <span class="dv">1</span> <span class="dv">101</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="dv">2</span>    <span class="dv">1</span> <span class="dv">102</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">2</span>        <span class="dv">1</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="dv">3</span>    <span class="dv">1</span> <span class="dv">103</span>    <span class="dv">135</span>    <span class="dv">136</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="dv">4</span>    <span class="dv">1</span> <span class="dv">104</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="dv">5</span>    <span class="dv">1</span> <span class="dv">105</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>       <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="dv">6</span>    <span class="dv">1</span> <span class="dv">106</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">2</span>       <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="dv">7</span>    <span class="dv">1</span> <span class="dv">107</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="dv">8</span>    <span class="dv">1</span> <span class="dv">108</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="dv">9</span>    <span class="dv">1</span> <span class="dv">109</span>    <span class="dv">101</span>    <span class="dv">102</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="dv">10</span>   <span class="dv">1</span> <span class="dv">110</span>    <span class="dv">103</span>    <span class="dv">104</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">pedAll &lt;-<span class="st"> </span><span class="kw">pedigree</span>(<span class="dt">id =</span> sample.ped<span class="op">$</span>id, <span class="dt">dadid =</span> sample.ped<span class="op">$</span>father, <span class="dt">momid =</span> sample.ped<span class="op">$</span>mother, </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    <span class="dt">sex =</span> sample.ped<span class="op">$</span>sex, <span class="dt">famid =</span> sample.ped<span class="op">$</span>ped)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="kw">print</span>(pedAll)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">Pedigree list with <span class="dv">55</span> total subjects <span class="cf">in</span> <span class="dv">2</span> families</a></code></pre></div>
<p>The {} object can be subset to individual pedigrees by their family id. The pedigree object has a print and plot method, which we show below. The print method prints a short summary of the pedigree, while the figure below displays the smaller pedigree.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">ped1basic &lt;-<span class="st"> </span>pedAll[<span class="st">"1"</span>]</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">ped2basic &lt;-<span class="st"> </span>pedAll[<span class="st">"2"</span>]</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">print</span>(ped1basic)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">Pedigree object with <span class="dv">41</span> subjects, family id=<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">Bit size=<span class="st"> </span><span class="dv">46</span> </a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">print</span>(ped2basic)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">Pedigree object with <span class="dv">14</span> subjects, family id=<span class="st"> </span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">Bit size=<span class="st"> </span><span class="dv">16</span> </a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw">plot</span>(ped2basic)</a></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/plot12-1.png" width="700"></p>
</div>
</div>
<div id="fixing-pedigree-issues" class="section level1">
<h1 class="hasAnchor">
<a href="#fixing-pedigree-issues" class="anchor"></a>Fixing Pedigree Issues</h1>
<p>To “break” the pedigree, we can manipulate the sex value to not match the parent value (in this example, we change <span class="math inline">\(203\)</span> from a male to a female, even though <span class="math inline">\(203\)</span> is a father). To do this, we first subset <sub>datped2</sub>, locate the <em>id</em> column, and match it to a specific id (in this case, <span class="math inline">\(203\)</span>). Within id <span class="math inline">\(203\)</span>, then locate in the <em>sex</em> column. Assign this subset to the incorrect value of <em>2</em> (female) to change the original/correct value of <em>1</em> (male).</p>
<p>To further break the pedigree, we can delete subjects who seem irrelevant to the pedigree (in this example, we delete <span class="math inline">\(209\)</span> because he is a married-in father). To do this, we subset <sub>datped2</sub> and use the <em>-which()</em> function to locate and delete the specified subject (in this case, <span class="math inline">\(209\)</span>). Reassign this code to <sub>datped22</sub> to drop the specified subject entirely.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datped2</span> <span class="op">&lt;-</span> <span class="va">sample.ped</span><span class="op">[</span><span class="va">sample.ped</span><span class="op">$</span><span class="va">ped</span> <span class="op">%in%</span> <span class="fl">2</span>, <span class="op">]</span>
<span class="va">datped2</span><span class="op">[</span><span class="va">datped2</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="fl">203</span>, <span class="st">"sex"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">datped2</span> <span class="op">&lt;-</span> <span class="va">datped2</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">datped2</span><span class="op">$</span><span class="va">id</span> <span class="op">%in%</span> <span class="fl">209</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<p>An error occurs when the <em>pedigree()</em> function notices that id <span class="math inline">\(203\)</span> is not coded to be male (<em>1</em>) but is a father. To correct this, we simply employ the <em>fixParents()</em> function to adjust the <em>sex</em> value to match either <em>mother/momid</em> or <em>father/dadid</em>. <em>fixParents()</em> will also add back in any deleted subjects, further fixing the pedigree.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ped2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">datped2</span>, <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">father</span>, <span class="va">mother</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To correct this, we simply employ the <em>fixParents()</em> function to adjust the <em>sex</em> value to match either <em>mother/momid</em> or <em>father/dadid</em>. <em>fixParents()</em> will also add back in any deleted subjects, further fixing the pedigree.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">fixped2 &lt;-<span class="st"> </span><span class="kw">with</span>(datped2, <span class="kw">fixParents</span>(id, father, mother, sex))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">fixped2</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">    id momid dadid sex</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="dv">1</span>  <span class="dv">201</span>     <span class="dv">0</span>     <span class="dv">0</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="dv">2</span>  <span class="dv">202</span>     <span class="dv">0</span>     <span class="dv">0</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="dv">3</span>  <span class="dv">203</span>     <span class="dv">0</span>     <span class="dv">0</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="dv">4</span>  <span class="dv">204</span>   <span class="dv">202</span>   <span class="dv">201</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="dv">5</span>  <span class="dv">205</span>   <span class="dv">202</span>   <span class="dv">201</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="dv">6</span>  <span class="dv">206</span>   <span class="dv">202</span>   <span class="dv">201</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="dv">7</span>  <span class="dv">207</span>   <span class="dv">202</span>   <span class="dv">201</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="dv">8</span>  <span class="dv">208</span>   <span class="dv">202</span>   <span class="dv">201</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="dv">9</span>  <span class="dv">210</span>   <span class="dv">204</span>   <span class="dv">203</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="dv">10</span> <span class="dv">211</span>   <span class="dv">204</span>   <span class="dv">203</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="dv">11</span> <span class="dv">212</span>   <span class="dv">208</span>   <span class="dv">209</span>   <span class="dv">2</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="dv">12</span> <span class="dv">213</span>   <span class="dv">208</span>   <span class="dv">209</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="dv">13</span> <span class="dv">214</span>   <span class="dv">208</span>   <span class="dv">209</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="dv">14</span> <span class="dv">209</span>     <span class="dv">0</span>     <span class="dv">0</span>   <span class="dv">1</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">ped2 &lt;-<span class="st"> </span><span class="kw">with</span>(fixped2, <span class="kw">pedigree</span>(id, dadid, momid, sex))</a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="kw">plot</span>(ped2)</a></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/fixped-1.png" width="700"></p>
<p>If the fix is straightforward (changing one sex value based on either being a mother or father), <em>fixParents()</em> will resolve the issue. If the issue is more complicated, say if <span class="math inline">\(203\)</span> is coded to be both a father <em>and</em> a mother, fixParents will not know which one is correct and therefore the issue will not be resolved.</p>
</div>
<div id="kinship" class="section level1">
<h1 class="hasAnchor">
<a href="#kinship" class="anchor"></a>Kinship</h1>
<p>A common use for pedigrees is to make a matrix of kinship coefficients that can be used in mixed effect models. A kinship coefficient is the probability that a randomly selected allele from two people at a given locus will be identical by descent (IBD), assuming all founder alleles are independent. For example, we each have two alleles per autosomal marker, so sampling two alleles with replacement from our own DNA has only <span class="math inline">\(p=0.50\)</span> probability of getting the same allele twice.</p>

<p>We use {} to calculate the kinship matrix for <span class="math inline">\(ped2basic\)</span>. The result is a special symmetrix matrix class from the <span class="math inline">\(Matrix\)</span> R package, which is stored efficiently to avoid repeating elements.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">kin2 &lt;-<span class="st"> </span><span class="kw">kinship</span>(ped2basic)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">kin2</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">      <span class="dv">201</span>   <span class="dv">202</span>  <span class="dv">203</span>   <span class="dv">204</span>   <span class="dv">205</span>   <span class="dv">206</span>   <span class="dv">207</span>   <span class="dv">208</span>  <span class="dv">209</span>    <span class="dv">210</span>    <span class="dv">211</span>    <span class="dv">212</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="dv">201</span> <span class="fl">0.500</span> <span class="fl">0.000</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="dv">202</span> <span class="fl">0.000</span> <span class="fl">0.500</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="dv">203</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.50</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.00</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.0000</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="dv">204</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="dv">205</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="dv">206</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="dv">207</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="dv">208</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.00</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="dv">209</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.00</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.50</span> <span class="fl">0.0000</span> <span class="fl">0.0000</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="dv">210</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.25</span> <span class="fl">0.250</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="dv">211</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.25</span> <span class="fl">0.250</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="dv">212</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.250</span> <span class="fl">0.25</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="dv">213</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.250</span> <span class="fl">0.25</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="dv">214</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.250</span> <span class="fl">0.25</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">       <span class="dv">213</span>    <span class="dv">214</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="dv">201</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="dv">202</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="dv">203</span> <span class="fl">0.0000</span> <span class="fl">0.0000</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="dv">204</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="dv">205</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="dv">206</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="dv">207</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="dv">208</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="dv">209</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="dv">210</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="dv">211</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="dv">212</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="dv">213</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="dv">214</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span></a></code></pre></div>
<p>For family 2, see that the row and column names match the id in the figure below, and see that each kinship coefficient with themselves is <span class="math inline">\(0.50\)</span>, siblings are <span class="math inline">\(0.25\)</span> (e.g. <span class="math inline">\(204-205\)</span>), and pedigree marry-ins only share alleles IBD with their children with coefficient <span class="math inline">\(0.25\)</span> (e.g. <span class="math inline">\(203-210\)</span>). The plot can be used to verify other kinship coefficients.</p>
<div id="kinship-for-pedigreelist-object" class="section level2">
<h2 class="hasAnchor">
<a href="#kinship-for-pedigreelist-object" class="anchor"></a>Kinship for pedigreeList object</h2>
<p>The kinship function also works on a {} object. We show how to create the kinship matrix, then show a snapshot of them for the two families, where the row and columns names are the ids of the subject.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pedAll &lt;-<span class="st"> </span><span class="kw">pedigree</span>(<span class="dt">id =</span> sample.ped<span class="op">$</span>id, <span class="dt">dadid =</span> sample.ped<span class="op">$</span>father, <span class="dt">momid =</span> sample.ped<span class="op">$</span>mother, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">    <span class="dt">sex =</span> sample.ped<span class="op">$</span>sex, <span class="dt">famid =</span> sample.ped<span class="op">$</span>ped)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">kinAll &lt;-<span class="st"> </span><span class="kw">kinship</span>(pedAll)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">kinAll[<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">14</span>]</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="dv">14</span> x <span class="dv">14</span> sparse Matrix of class <span class="st">"dsCMatrix"</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">   [[ suppressing <span class="dv">14</span> column names <span class="st">'101'</span>, <span class="st">'102'</span>, <span class="st">'103'</span> ... ]]</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                                                                    </a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="dv">101</span> <span class="fl">0.50</span> .    .    .    .   .   .   .   <span class="fl">0.25</span> .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="dv">102</span> .    <span class="fl">0.50</span> .    .    .   .   .   .   <span class="fl">0.25</span> .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="dv">103</span> .    .    <span class="fl">0.50</span> .    .   .   .   .   .    <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="dv">104</span> .    .    .    <span class="fl">0.50</span> .   .   .   .   .    <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="dv">105</span> .    .    .    .    <span class="fl">0.5</span> .   .   .   .    .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="dv">106</span> .    .    .    .    .   <span class="fl">0.5</span> .   .   .    .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="dv">107</span> .    .    .    .    .   .   <span class="fl">0.5</span> .   .    .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="dv">108</span> .    .    .    .    .   .   .   <span class="fl">0.5</span> .    .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="dv">109</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .    .    .   .   .   .   <span class="fl">0.50</span> .    .    .    .   .   </a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="dv">110</span> .    .    <span class="fl">0.25</span> <span class="fl">0.25</span> .   .   .   .   .    <span class="fl">0.50</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="dv">111</span> .    .    <span class="fl">0.25</span> <span class="fl">0.25</span> .   .   .   .   .    <span class="fl">0.25</span> <span class="fl">0.50</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="dv">112</span> .    .    <span class="fl">0.25</span> <span class="fl">0.25</span> .   .   .   .   .    <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.50</span> .   <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="dv">113</span> .    .    .    .    .   .   .   .   .    .    .    .    <span class="fl">0.5</span> .   </a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="dv">114</span> .    .    <span class="fl">0.25</span> <span class="fl">0.25</span> .   .   .   .   .    <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.50</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22">kinAll[<span class="dv">40</span><span class="op">:</span><span class="dv">43</span>, <span class="dv">40</span><span class="op">:</span><span class="dv">43</span>]</a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="dv">4</span> x <span class="dv">4</span> sparse Matrix of class <span class="st">"dsCMatrix"</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24">     <span class="dv">140</span>  <span class="dv">141</span> <span class="dv">201</span> <span class="dv">202</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="dv">140</span> <span class="fl">0.50</span> <span class="fl">0.25</span> .   .  </a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="dv">141</span> <span class="fl">0.25</span> <span class="fl">0.50</span> .   .  </a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="dv">201</span> .    .    <span class="fl">0.5</span> .  </a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="dv">202</span> .    .    .   <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29">kinAll[<span class="dv">42</span><span class="op">:</span><span class="dv">46</span>, <span class="dv">42</span><span class="op">:</span><span class="dv">46</span>]</a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="dv">5</span> x <span class="dv">5</span> sparse Matrix of class <span class="st">"dsCMatrix"</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31">     <span class="dv">201</span>  <span class="dv">202</span> <span class="dv">203</span>  <span class="dv">204</span>  <span class="dv">205</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="dv">201</span> <span class="fl">0.50</span> .    .   <span class="fl">0.25</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="dv">202</span> .    <span class="fl">0.50</span> .   <span class="fl">0.25</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="dv">203</span> .    .    <span class="fl">0.5</span> .    .   </a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="dv">204</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.50</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="dv">205</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span> <span class="fl">0.50</span></a></code></pre></div>
</div>
<div id="kinship-for-twins-in-pedigreelist-object" class="section level2">
<h2 class="hasAnchor">
<a href="#kinship-for-twins-in-pedigreelist-object" class="anchor"></a>Kinship for twins in pedigreeList object</h2>
<p>Specifying twin relationships in a pedigreeList object is complicated by the fact that the user must specify the family id to which the <sub>id1</sub> and <sub>id2</sub> belong. We show below the relation matrix requires the family id to be in the last column, with the column names as done below, to make the plotting and kinship matrices to show up with the monozygotic twins correctly. We show how to specify monozygosity for subjects 206 and 207 in sample pedigree 2, and subjects 125 and 126 in pedigree 1. We check it by looking at the kinship matrix for these pairs, which are correctly at <span class="math inline">\(0.5\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">reltwins &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">colnames</span>(reltwins) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"id1"</span>, <span class="st">"id2"</span>, <span class="st">"code"</span>, <span class="st">"famid"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">pedAll &lt;-<span class="st"> </span><span class="kw">with</span>(sample.ped, <span class="kw">pedigree</span>(<span class="dt">id =</span> id, <span class="dt">dadid =</span> father, <span class="dt">momid =</span> mother, <span class="dt">sex =</span> sex, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="dt">famid =</span> ped, <span class="dt">relation =</span> reltwins))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">kinAll &lt;-<span class="st"> </span><span class="kw">kinship</span>(pedAll)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">kinAll[<span class="dv">21</span><span class="op">:</span><span class="dv">31</span>, <span class="dv">21</span><span class="op">:</span><span class="dv">31</span>]</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="dv">11</span> x <span class="dv">11</span> sparse Matrix of class <span class="st">"dsCMatrix"</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">   [[ suppressing <span class="dv">11</span> column names <span class="st">'121'</span>, <span class="st">'122'</span>, <span class="st">'123'</span> ... ]]</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                                                                         </a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="dv">121</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> .      .     </a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="dv">122</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> .      .     </a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="dv">123</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> .      .     </a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="dv">124</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> .      .     </a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="dv">125</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span> <span class="fl">0.5000</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="dv">126</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span> <span class="fl">0.5000</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="dv">127</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="dv">128</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="dv">129</span> .      .      .      .      <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="dv">130</span> .      .      .      .      <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="dv">131</span> .      .      .      .      <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21">          </a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="dv">121</span> .     </a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="dv">122</span> .     </a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="dv">123</span> .     </a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="dv">124</span> .     </a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="dv">125</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="dv">126</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="dv">127</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="dv">128</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="dv">129</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="dv">130</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="dv">131</span> <span class="fl">0.5000</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33">kinAll[<span class="dv">42</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">42</span><span class="op">:</span><span class="dv">50</span>]</a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="dv">9</span> x <span class="dv">9</span> sparse Matrix of class <span class="st">"dsCMatrix"</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35">     <span class="dv">201</span>  <span class="dv">202</span> <span class="dv">203</span>  <span class="dv">204</span>  <span class="dv">205</span>  <span class="dv">206</span>  <span class="dv">207</span>  <span class="dv">208</span> <span class="dv">209</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="dv">201</span> <span class="fl">0.50</span> .    .   <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="dv">202</span> .    <span class="fl">0.50</span> .   <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="dv">203</span> .    .    <span class="fl">0.5</span> .    .    .    .    .    .  </a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="dv">204</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.50</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="dv">205</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span> <span class="fl">0.50</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="dv">206</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.50</span> <span class="fl">0.50</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="dv">207</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.50</span> <span class="fl">0.50</span> <span class="fl">0.25</span> .  </a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="dv">208</span> <span class="fl">0.25</span> <span class="fl">0.25</span> .   <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.25</span> <span class="fl">0.50</span> .  </a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="dv">209</span> .    .    .   .    .    .    .    .    <span class="fl">0.5</span></a></code></pre></div>
<p>Note that subject <span class="math inline">\(113\)</span> is not in pedigree 1 because they are a marry-in without children in the pedigree. Subject <span class="math inline">\(113\)</span> is in their own pedigree of size 1 in the <span class="math inline">\(kinAll\)</span> matrix at index <span class="math inline">\(41\)</span>. We later show how to handle such marry-ins for plotting.</p>
</div>
</div>
<div id="optional-pedigree-features" class="section level1">
<h1 class="hasAnchor">
<a href="#optional-pedigree-features" class="anchor"></a>Optional Pedigree Features</h1>
<p>We use pedigree 2 from <span class="math inline">\(sample.ped\)</span> to sequentially add optional information to the pedigree object.</p>

<p>The example below shows how to specify a <span class="math inline">\(status\)</span> indicator, such as vital status. The <span class="math inline">\(sample.ped\)</span> data does not include such an<br>
indicator, so we create one to indicate that the first generation of pedigree 2, subjects 1 and 2, are deceased.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">df2 &lt;-<span class="st"> </span>sample.ped[sample.ped<span class="op">$</span>ped <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">names</span>(df2)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">[<span class="dv">1</span>] <span class="st">"ped"</span>      <span class="st">"id"</span>       <span class="st">"father"</span>   <span class="st">"mother"</span>   <span class="st">"sex"</span>      <span class="st">"affected"</span> <span class="st">"avail"</span>   </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">df2<span class="op">$</span>censor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">ped2 &lt;-<span class="st"> </span><span class="kw">pedigree</span>(df2<span class="op">$</span>id, df2<span class="op">$</span>father, df2<span class="op">$</span>mother, df2<span class="op">$</span>sex, <span class="dt">status =</span> df2<span class="op">$</span>censor)</a></code></pre></div>
<div id="affected-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#affected-indicators" class="anchor"></a>Affected Indicators</h2>
<p>We show how to specify affected status with a single indicator and multiple indicators in a matrix. First, we use the affected indicator from <span class="math inline">\(sample.ped\)</span>, which contains 0/1 indicators and NA as missing, and let it it indicate blue eyes. Next, we create a matrix to contain the affected indicator from <span class="math inline">\(sample.ped\)</span> and a second indicator that we create, imagine as an indicator for baldness.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ped2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">id</span>, <span class="va">df2</span><span class="op">$</span><span class="va">father</span>, <span class="va">df2</span><span class="op">$</span><span class="va">mother</span>, <span class="va">df2</span><span class="op">$</span><span class="va">sex</span>, affected <span class="op">=</span> <span class="va">df2</span><span class="op">$</span><span class="va">affected</span>, 
    status <span class="op">=</span> <span class="va">df2</span><span class="op">$</span><span class="va">censor</span><span class="op">)</span>
<span class="va">aff2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>blue <span class="op">=</span> <span class="va">df2</span><span class="op">$</span><span class="va">affected</span>, bald <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, 
    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">ped2aff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">id</span>, <span class="va">df2</span><span class="op">$</span><span class="va">father</span>, <span class="va">df2</span><span class="op">$</span><span class="va">mother</span>, <span class="va">df2</span><span class="op">$</span><span class="va">sex</span>, affected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aff2</span><span class="op">)</span>, 
    status <span class="op">=</span> <span class="va">df2</span><span class="op">$</span><span class="va">censor</span><span class="op">)</span></code></pre></div>
</div>
<div id="special-relationships" class="section level2">
<h2 class="hasAnchor">
<a href="#special-relationships" class="anchor"></a>Special Relationships</h2>
<p>Special pedigree relationships can be specified in a matrix as the <span class="math inline">\(relation\)</span> argument. There are 4 relationships that can be specified by numeric codes: 1=Monozygotic twins, 2=Dizygotic twins, 3=Twins of unknown zygosity, and 4=Spouse. The spouse relationship can indicate a marry-in when a couple does not have children together.</p>
<p>Below, we create a matrix of relationships for monozygotic and unknown-zygosity twins in the most recent generation of pedigree 2.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## create twin relationships</span>
<span class="va">relate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">210</span>, <span class="fl">211</span>, <span class="fl">1</span>, <span class="fl">212</span>, <span class="fl">213</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ped2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">id</span>, <span class="va">df2</span><span class="op">$</span><span class="va">father</span>, <span class="va">df2</span><span class="op">$</span><span class="va">mother</span>, <span class="va">df2</span><span class="op">$</span><span class="va">sex</span>, affected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aff2</span><span class="op">)</span>, 
    status <span class="op">=</span> <span class="va">df2</span><span class="op">$</span><span class="va">censor</span>, relation <span class="op">=</span> <span class="va">relate2</span><span class="op">)</span></code></pre></div>
<p>Another special relationship is inbreeding. Inbreeding of founders implies the founder parents are related (the maternal and paternal genes descended from a single ancestral gene). One thing we can do is add more people to the pedigree to show this inbreeding.</p>
<p>To show that a pair of founders (subjects <span class="math inline">\(201\)</span> and <span class="math inline">\(202\)</span>) are inbred, we must show that their parents are siblings. To do this, we create subjects <span class="math inline">\(197\)</span> and <span class="math inline">\(198\)</span> to be the parents of <span class="math inline">\(201\)</span> and also create subjects <span class="math inline">\(199\)</span> and <span class="math inline">\(200\)</span> to be the parents of <span class="math inline">\(202\)</span>. To make subjects <span class="math inline">\(198\)</span> and <span class="math inline">\(199\)</span> siblings, we give <em>them</em> the same parents, creating subjects <span class="math inline">\(195\)</span> and <span class="math inline">\(196\)</span>. This results in subjects <span class="math inline">\(201\)</span> and <span class="math inline">\(202\)</span> being first cousins, and therefore inbred.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">195</span><span class="op">:</span><span class="fl">202</span>
<span class="va">dadid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">196</span>, <span class="fl">196</span>, <span class="fl">0</span>, <span class="fl">197</span>, <span class="fl">199</span><span class="op">)</span>
<span class="va">momid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">195</span>, <span class="fl">195</span>, <span class="fl">0</span>, <span class="fl">198</span>, <span class="fl">200</span><span class="op">)</span>
<span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">ped3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">dadid</span>, <span class="va">momid</span>, <span class="va">sex</span><span class="op">)</span>
<span class="va">ped4df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ped2</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ped3</span><span class="op">)</span><span class="op">)</span>
<span class="va">ped4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">ped4df</span>, <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">dadid</span>, <span class="va">momid</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ped4</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/inbreeding-1.png" width="700"></p>
</div>
</div>
<div id="pedigree-plot-details" class="section level1">
<h1 class="hasAnchor">
<a href="#pedigree-plot-details" class="anchor"></a>Pedigree Plot Details</h1>
<p>The plot method does an admirable job plotting pedigrees within the standard R plotting paradigm. It attempts to adhere to many standards in pedigree plotting, as presented in Bennet et al. 2008.</p>
<p>We show in the following figure, the plot of the updated pedigree 2. The plot shapes for each subject are divided into two equal parts and shaded differently to indicate the two affected indicators. Also, the two deceased subjects are displayed with a diagonal line through the shape. The twin relationships are both represented with diverging lines from a single point. The monozygotic twins have an additional line connecting the diverging lines, while the other twins have a question mark to indicate unknown zygosity.</p>
<p>We also show how the subjects can be colored individually, where we color a subject red if their <sub>avail</sub> indicator is 1, which can represent their DNA availability, a useful indicator in genetic studies. Lastly, we show how to use the <span class="math inline">\(id\)</span> argument in the plot method to add additional information under each subject. In the example below, we add names to the existing <span class="math inline">\(id\)</span> vector using the newline character as the <span class="math inline">\(sep\)</span> argument in <em>paste()</em>. As space permits, more lines and characters per line can be made using the <span class="math inline">\(id\)</span> argument.</p>
<p>Finally, we show how a pedigree.legend can place a simple legend in one of the corners of the pedigree plot to show the sections of the plot symbols corresponding to the multiple affected indicators.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">id2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Linda"</span>, <span class="st">"Jack"</span>, <span class="st">"Rachel"</span>, <span class="st">"Joe"</span>, <span class="st">"Deb"</span>, <span class="st">"Lucy"</span>, <span class="st">"Ken"</span>, 
    <span class="st">"Barb"</span>, <span class="st">"Mike"</span>, <span class="st">"Matt"</span>, <span class="st">"Mindy"</span>, <span class="st">"Mark"</span>, <span class="st">"George"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ped2aff</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">avail</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, id <span class="op">=</span> <span class="va">id2</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.legend.html">pedigree.legend</a></span><span class="op">(</span><span class="va">ped2aff</span>, location <span class="op">=</span> <span class="st">"topright"</span>, radius <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/ped2update-1.png" width="700"></p>
<p>To show some other tricks with pedigree plotting, we use pedigree 1 from <sub>sample.ped</sub>, which has 41 subjects in 4 generations, including a generation with double first cousins. After the first marriage of 114, they remarried subject 113 without children between them. If we do not specify the marriage with the <span class="math inline">\(relation\)</span> argument, the plot method excludes subject <span class="math inline">\(113\)</span> from the plot. The basic plot of pedigree 1 is shown in the figure below, where the subjects are colored red if their <sub>avail</sub> indicator is 1.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">df1 &lt;-<span class="st"> </span>sample.ped[sample.ped<span class="op">$</span>ped <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">relate1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">4</span>), <span class="dt">nrow =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">ped1 &lt;-<span class="st"> </span><span class="kw">pedigree</span>(df1<span class="op">$</span>id, df1<span class="op">$</span>father, df1<span class="op">$</span>mother, df1<span class="op">$</span>sex, <span class="dt">affected =</span> df1<span class="op">$</span>affected, </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="dt">relation =</span> relate1)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw">print</span>(ped1)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">Pedigree object with <span class="dv">41</span> subjects</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">Bit size=<span class="st"> </span><span class="dv">46</span> </a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="kw">plot</span>(ped1, <span class="dt">col =</span> <span class="kw">ifelse</span>(df1<span class="op">$</span>avail <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">"red"</span>, <span class="st">"black"</span>))</a></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/plotped1-1.png" width="700"></p>
<div id="align-by-input-order" class="section level2">
<h2 class="hasAnchor">
<a href="#align-by-input-order" class="anchor"></a>Align by Input Order</h2>
<p>The plot method does a decent job aligning subjects given the order of the subjects when the pedigree object is made, and sometimes has to make two copies of a subject. If we change the order of the subjects when creating the pedigree, we can help the plot method reduce the need to duplicate subjects, as the figure below no longer has subject <span class="math inline">\(110\)</span> duplicated.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1reord</span> <span class="op">&lt;-</span> <span class="va">df1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">35</span><span class="op">:</span><span class="fl">41</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">34</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">ped1reord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html">pedigree</a></span><span class="op">(</span><span class="va">df1reord</span><span class="op">$</span><span class="va">id</span>, <span class="va">df1reord</span><span class="op">$</span><span class="va">father</span>, <span class="va">df1reord</span><span class="op">$</span><span class="va">mother</span>, <span class="va">df1reord</span><span class="op">$</span><span class="va">sex</span>, 
    affected <span class="op">=</span> <span class="va">df1reord</span><span class="op">$</span><span class="va">affected</span>, relation <span class="op">=</span> <span class="va">relate1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ped1reord</span>, col <span class="op">=</span> <span class="va">df1reord</span><span class="op">$</span><span class="va">avail</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/ordering-1.png" width="700"></p>
</div>
<div id="legend-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#legend-plot" class="anchor"></a>Legend Plot</h2>
<p>The <em>legendPlot</em> function creates a dynamic legend based on the arguments passed to it for the affection and color vector. The first example below shows how it uses the affected matrix for the first legend.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/plot.pedigree.html">legendPlot</a></span><span class="op">(</span><span class="va">ped2aff</span><span class="op">)</span></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/legendplot-1.png" width="700"></p>
<p>The second example adds more legend symbols to explain the colors, with the ability to add more detail to the <em>affected.label</em> argument. The color here shades by the second affected indicator, but we could have it mean something like DNA available, which we show below. The <sub>col.label</sub> requires the same number of text labels as there are colors.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/plot.pedigree.html">legendPlot</a></span><span class="op">(</span><span class="va">ped2aff</span>, col <span class="op">=</span> <span class="va">ped2</span><span class="op">$</span><span class="va">affected</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>, col.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DNA Avail"</span>, <span class="st">"no DNA"</span><span class="op">)</span>, 
    affected.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue eyes"</span>, <span class="st">"bald"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/legend2plot-1.png" width="700"></p>
</div>
</div>
<div id="pedigree-utility-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#pedigree-utility-functions" class="anchor"></a>Pedigree Utility Functions</h1>
<div id="pedigree-as-a-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#pedigree-as-a-data-frame" class="anchor"></a>Pedigree as a Data.Frame</h2>
<p>A main features of a pedigree object are vectors with an element for each subject. It is sometimes useful to extract these vectors from the pedigree object into a <span class="math inline">\(data.frame\)</span> with basic information that can be used to construct a new pedigree object. This is possible with the <span class="math inline">\(as.data.frame()\)</span> method, as shown below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">dfped2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(ped2)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">dfped2</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">    id dadid momid    sex affected.blue affected.bald status</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="dv">1</span>  <span class="dv">201</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">1</span>             <span class="dv">0</span>      <span class="dv">1</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="dv">2</span>  <span class="dv">202</span>     <span class="dv">0</span>     <span class="dv">0</span> female            <span class="ot">NA</span>             <span class="dv">0</span>      <span class="dv">1</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="dv">3</span>  <span class="dv">203</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">1</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="dv">4</span>  <span class="dv">204</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">0</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="dv">5</span>  <span class="dv">205</span>   <span class="dv">201</span>   <span class="dv">202</span>   male            <span class="ot">NA</span>             <span class="dv">1</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="dv">6</span>  <span class="dv">206</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">1</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="dv">7</span>  <span class="dv">207</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">1</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="dv">8</span>  <span class="dv">208</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">0</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="dv">9</span>  <span class="dv">209</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">0</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="dv">10</span> <span class="dv">210</span>   <span class="dv">203</span>   <span class="dv">204</span>   male             <span class="dv">0</span>             <span class="dv">1</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="dv">11</span> <span class="dv">211</span>   <span class="dv">203</span>   <span class="dv">204</span>   male             <span class="dv">0</span>             <span class="dv">1</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="dv">12</span> <span class="dv">212</span>   <span class="dv">209</span>   <span class="dv">208</span> female             <span class="dv">0</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="dv">13</span> <span class="dv">213</span>   <span class="dv">209</span>   <span class="dv">208</span>   male             <span class="dv">0</span>             <span class="dv">0</span>      <span class="dv">0</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="dv">14</span> <span class="dv">214</span>   <span class="dv">209</span>   <span class="dv">208</span>   male             <span class="dv">1</span>             <span class="dv">1</span>      <span class="dv">0</span></a></code></pre></div>
</div>
<div id="subsetting-and-trimming" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-and-trimming" class="anchor"></a>Subsetting and Trimming</h2>
<p>Pedigrees with large size can be a bottleneck for programs that run calculations on them. The kinship2 package contains some routines to identify which subjects to remove. We show how a subject (e.g. subject 210) can be removed from <sub>ped2</sub>, and how the pedigree object is changed by verifying that the <sub>relation</sub> matrix no longer has the twin relationship between subjects 210 and 211, as indicated by <span class="math inline">\(indx1\)</span> and <sub>indx2</sub>. Also note that the <span class="math inline">\(relation\)</span> matrix indices are updated for persons 212 and 213 who have index 11 and 12 after subject 210 is removed.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">ped2.rm210 &lt;-<span class="st"> </span>ped2[<span class="op">-</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">data.frame</span>(ped2.rm210)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">    id dadid momid    sex affected.blue affected.bald</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="dv">1</span>  <span class="dv">201</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">1</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="dv">2</span>  <span class="dv">202</span>     <span class="dv">0</span>     <span class="dv">0</span> female            <span class="ot">NA</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="dv">3</span>  <span class="dv">203</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">1</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="dv">4</span>  <span class="dv">204</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">0</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="dv">5</span>  <span class="dv">205</span>   <span class="dv">201</span>   <span class="dv">202</span>   male            <span class="ot">NA</span>             <span class="dv">1</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="dv">6</span>  <span class="dv">206</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">1</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="dv">7</span>  <span class="dv">207</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">1</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="dv">8</span>  <span class="dv">208</span>   <span class="dv">201</span>   <span class="dv">202</span> female             <span class="dv">0</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="dv">9</span>  <span class="dv">209</span>     <span class="dv">0</span>     <span class="dv">0</span>   male             <span class="dv">0</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="dv">10</span> <span class="dv">211</span>   <span class="dv">203</span>   <span class="dv">204</span>   male             <span class="dv">0</span>             <span class="dv">1</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="dv">11</span> <span class="dv">212</span>   <span class="dv">209</span>   <span class="dv">208</span> female             <span class="dv">0</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="dv">12</span> <span class="dv">213</span>   <span class="dv">209</span>   <span class="dv">208</span>   male             <span class="dv">0</span>             <span class="dv">0</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="dv">13</span> <span class="dv">214</span>   <span class="dv">209</span>   <span class="dv">208</span>   male             <span class="dv">1</span>             <span class="dv">1</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17">ped2.rm210<span class="op">$</span>relation</a>
<a class="sourceLine" id="cb20-18" data-line-number="18">  indx1 indx2    code</a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="dv">2</span>    <span class="dv">11</span>    <span class="dv">12</span> UZ twin</a>
<a class="sourceLine" id="cb20-20" data-line-number="20">ped2<span class="op">$</span>relation</a>
<a class="sourceLine" id="cb20-21" data-line-number="21">  indx1 indx2    code</a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="dv">1</span>    <span class="dv">10</span>    <span class="dv">11</span> MZ twin</a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="dv">2</span>    <span class="dv">12</span>    <span class="dv">13</span> UZ twin</a></code></pre></div>
<p>The steps above only work for subsetting by the index of the pedigree object vectors, not by the <sub>id</sub> of the subjects themselves.<br>
We provide <em>pedigree.trim()</em>, which trims subjects from a pedigree by their <span class="math inline">\(id\)</span>. Below is an example of removing subject 110, as done above, then we further trim the pedigree by a vector of subject ids. We check the trimming by looking at the <span class="math inline">\(id\)</span> vector and the <span class="math inline">\(relation\)</span> matrix.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">ped2.trim210 &lt;-<span class="st"> </span><span class="kw">pedigree.trim</span>(<span class="dv">210</span>, ped2)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">ped2.trim210<span class="op">$</span>id</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"> [<span class="dv">1</span>] <span class="dv">201</span> <span class="dv">202</span> <span class="dv">203</span> <span class="dv">204</span> <span class="dv">205</span> <span class="dv">206</span> <span class="dv">207</span> <span class="dv">208</span> <span class="dv">209</span> <span class="dv">211</span> <span class="dv">212</span> <span class="dv">213</span> <span class="dv">214</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">ped2.trim210<span class="op">$</span>relation</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  indx1 indx2    code</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="dv">2</span>    <span class="dv">11</span>    <span class="dv">12</span> UZ twin</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">ped2.trim.more &lt;-<span class="st"> </span><span class="kw">pedigree.trim</span>(<span class="kw">c</span>(<span class="dv">212</span>, <span class="dv">214</span>), ped2.trim210)</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">ped2.trim.more<span class="op">$</span>id</a>
<a class="sourceLine" id="cb21-9" data-line-number="9"> [<span class="dv">1</span>] <span class="dv">201</span> <span class="dv">202</span> <span class="dv">203</span> <span class="dv">204</span> <span class="dv">205</span> <span class="dv">206</span> <span class="dv">207</span> <span class="dv">208</span> <span class="dv">209</span> <span class="dv">211</span> <span class="dv">213</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10">ped2.trim.more<span class="op">$</span>relation</a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="ot">NULL</span></a></code></pre></div>
</div>
</div>
<div id="shrinking" class="section level1">
<h1 class="hasAnchor">
<a href="#shrinking" class="anchor"></a>Shrinking</h1>
<p>An additional function in kinship2 is <em>pedigree.shrink()</em>, which shrinks a pedigree to a specified bit size while maintaining the maximal amount of information for genetic linkage and association studies. Using an indicator for availability and affected status, it removes subjects in this order: + unavailable with no available descendants + available and are not parents + available who have missing affected status + available who are unaffected + available who are affected</p>
<p>We show how to shrink pedigree 1 to bit size <span class="math inline">\(30\)</span>, which happens to be the bit size after removing only the unavailable subjects. We show how to extract the shrunken pedigree object from the <span class="math inline">\(pedigree.shrink\)</span> result, and plot it.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">shrink1.B30 &lt;-<span class="st"> </span><span class="kw">pedigree.shrink</span>(<span class="dt">ped =</span> ped1, <span class="dt">avail =</span> df1<span class="op">$</span>avail, <span class="dt">maxBits =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">print</span>(shrink1.B30)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="op">==</span><span class="er">==============================================================================</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">                              </span>Shrink of Pedigree                                 </a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="op">==</span><span class="er">==============================================================================</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">Pedigree Size<span class="op">:</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">                 </span>N.subj Bits</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">Original             <span class="dv">41</span>   <span class="dv">46</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9">Only Informative     <span class="dv">28</span>   <span class="dv">29</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">Trimmed              <span class="dv">28</span>   <span class="dv">29</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"> Unavailable subjects trimmed<span class="op">:</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="st"> </span><span class="dv">101</span> <span class="dv">102</span> <span class="dv">107</span> <span class="dv">108</span> <span class="dv">111</span> <span class="dv">113</span> <span class="dv">121</span> <span class="dv">122</span> <span class="dv">123</span> <span class="dv">131</span> <span class="dv">132</span> <span class="dv">134</span> <span class="dv">139</span> </a>
<a class="sourceLine" id="cb22-14" data-line-number="14">ped1.B30 &lt;-<span class="st"> </span>shrink1.B30<span class="op">$</span>pedObj</a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="kw">plot</span>(ped1.B30, <span class="dt">col =</span> shrink1.B30<span class="op">$</span>avail <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/shrink1-1.png" width="700"></p>
<p>Now shrink pedigree 1 to bit size <span class="math inline">\(25\)</span>, which requires removing subjects who are informative. If there is a tie between multiple subjects about who to remove, the method randomly chooses one of them. With this seed setting, the method removes subjects <span class="math inline">\(126\)</span> then <span class="math inline">\(125\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">shrink1.B25 &lt;-<span class="st"> </span><span class="kw">pedigree.shrink</span>(<span class="dt">ped =</span> ped1, <span class="dt">avail =</span> df1<span class="op">$</span>avail, <span class="dt">maxBits =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">print</span>(shrink1.B25)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="op">==</span><span class="er">==============================================================================</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="st">                              </span>Shrink of Pedigree                                 </a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="op">==</span><span class="er">==============================================================================</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7">Pedigree Size<span class="op">:</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="st">                 </span>N.subj Bits</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">Original             <span class="dv">41</span>   <span class="dv">46</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">Only Informative     <span class="dv">28</span>   <span class="dv">29</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11">Trimmed              <span class="dv">26</span>   <span class="dv">25</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"> Unavailable subjects trimmed<span class="op">:</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="st"> </span><span class="dv">101</span> <span class="dv">102</span> <span class="dv">107</span> <span class="dv">108</span> <span class="dv">111</span> <span class="dv">113</span> <span class="dv">121</span> <span class="dv">122</span> <span class="dv">123</span> <span class="dv">131</span> <span class="dv">132</span> <span class="dv">134</span> <span class="dv">139</span> </a>
<a class="sourceLine" id="cb23-15" data-line-number="15"></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"> Informative subjects trimmed<span class="op">:</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="st"> </span><span class="dv">133</span> <span class="dv">141</span> </a>
<a class="sourceLine" id="cb23-18" data-line-number="18">ped1.B25 &lt;-<span class="st"> </span>shrink1.B25<span class="op">$</span>pedObj</a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="kw">plot</span>(ped1.B25, <span class="dt">col =</span> shrink1.B25<span class="op">$</span>avail <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="kinship2_walkthrough_files/figure-html/shrink2-1.png" width="700"></p>
</div>
<div id="select-unrelateds" class="section level1">
<h1 class="hasAnchor">
<a href="#select-unrelateds" class="anchor"></a>Select Unrelateds</h1>
<p>In this section we briefly show how to use <span class="math inline">\(pedigree.unrelated\)</span> to find a set of the maximum number of unrelated available subjects from a pedigree. The input required is a pedigree object and a vector indicating availability. In some pedigrees there are numerous sets of subjects that satisfy the maximum number of unrelateds, so the method randomly chooses from the set. We show two sets of subject ids that are selected by the routine and discuss below.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">df2 &lt;-<span class="st"> </span>sample.ped[sample.ped<span class="op">$</span>ped <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">ped2 &lt;-<span class="st"> </span><span class="kw">pedigree</span>(df2<span class="op">$</span>id, df2<span class="op">$</span>father, df2<span class="op">$</span>mother, df2<span class="op">$</span>sex, <span class="dt">affected =</span> df2<span class="op">$</span>affected)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">set1 &lt;-<span class="st"> </span><span class="kw">pedigree.unrelated</span>(ped2, <span class="dt">avail =</span> df2<span class="op">$</span>avail)</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">set1</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">[<span class="dv">1</span>] <span class="st">"203"</span> <span class="st">"206"</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7">set2 &lt;-<span class="st"> </span><span class="kw">pedigree.unrelated</span>(ped2, <span class="dt">avail =</span> df2<span class="op">$</span>avail)</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">set2</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">[<span class="dv">1</span>] <span class="st">"203"</span> <span class="st">"214"</span></a></code></pre></div>
<p>We can easily verify the sets selected by <span class="math inline">\(pedigree.unrelated\)</span> by referring to the plot below and see that subjects 203 and 209 are unrelated to everyone else in the pedigree except their children. Furthermore, we see in df2 that of these two, only subject 203 is available. Therefore, any set of unrelateds who are available must include subject 203 and one of the these subjects: 201, 204, 206, 207, 212, and 214, as indicated by the kinship matrix for pedigree 2 subset to those with availability status of 1.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">df2</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">   ped  id father mother sex affected avail</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="dv">42</span>   <span class="dv">2</span> <span class="dv">201</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="dv">43</span>   <span class="dv">2</span> <span class="dv">202</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">2</span>       <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="dv">44</span>   <span class="dv">2</span> <span class="dv">203</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="dv">45</span>   <span class="dv">2</span> <span class="dv">204</span>    <span class="dv">201</span>    <span class="dv">202</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="dv">46</span>   <span class="dv">2</span> <span class="dv">205</span>    <span class="dv">201</span>    <span class="dv">202</span>   <span class="dv">1</span>       <span class="ot">NA</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="dv">47</span>   <span class="dv">2</span> <span class="dv">206</span>    <span class="dv">201</span>    <span class="dv">202</span>   <span class="dv">2</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="dv">48</span>   <span class="dv">2</span> <span class="dv">207</span>    <span class="dv">201</span>    <span class="dv">202</span>   <span class="dv">2</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="dv">49</span>   <span class="dv">2</span> <span class="dv">208</span>    <span class="dv">201</span>    <span class="dv">202</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="dv">50</span>   <span class="dv">2</span> <span class="dv">209</span>      <span class="dv">0</span>      <span class="dv">0</span>   <span class="dv">1</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="dv">51</span>   <span class="dv">2</span> <span class="dv">210</span>    <span class="dv">203</span>    <span class="dv">204</span>   <span class="dv">1</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="dv">52</span>   <span class="dv">2</span> <span class="dv">211</span>    <span class="dv">203</span>    <span class="dv">204</span>   <span class="dv">1</span>        <span class="dv">0</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="dv">53</span>   <span class="dv">2</span> <span class="dv">212</span>    <span class="dv">209</span>    <span class="dv">208</span>   <span class="dv">2</span>        <span class="dv">0</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="dv">54</span>   <span class="dv">2</span> <span class="dv">213</span>    <span class="dv">209</span>    <span class="dv">208</span>   <span class="dv">1</span>        <span class="dv">0</span>     <span class="dv">0</span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="dv">55</span>   <span class="dv">2</span> <span class="dv">214</span>    <span class="dv">209</span>    <span class="dv">208</span>   <span class="dv">1</span>        <span class="dv">1</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17">kin2[df2<span class="op">$</span>avail <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, df2<span class="op">$</span>avail <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">      <span class="dv">201</span>  <span class="dv">203</span>   <span class="dv">204</span>   <span class="dv">206</span>   <span class="dv">207</span>    <span class="dv">211</span>    <span class="dv">212</span>    <span class="dv">214</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="dv">201</span> <span class="fl">0.500</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="dv">203</span> <span class="fl">0.000</span> <span class="fl">0.50</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.2500</span> <span class="fl">0.0000</span> <span class="fl">0.0000</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="dv">204</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.2500</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="dv">206</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="dv">207</span> <span class="fl">0.250</span> <span class="fl">0.00</span> <span class="fl">0.250</span> <span class="fl">0.250</span> <span class="fl">0.500</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span> <span class="fl">0.1250</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"><span class="dv">211</span> <span class="fl">0.125</span> <span class="fl">0.25</span> <span class="fl">0.250</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.5000</span> <span class="fl">0.0625</span> <span class="fl">0.0625</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="dv">212</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.0625</span> <span class="fl">0.5000</span> <span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"><span class="dv">214</span> <span class="fl">0.125</span> <span class="fl">0.00</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.125</span> <span class="fl">0.0625</span> <span class="fl">0.2500</span> <span class="fl">0.5000</span></a></code></pre></div>
</div>
<div id="r-session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#r-session-information" class="anchor"></a>R Session Information</h1>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">R version <span class="dv">4</span>.<span class="fl">0.3</span> (<span class="dv">2020-10-10</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">Platform<span class="op">:</span><span class="st"> </span>x86_<span class="dv">64</span><span class="op">-</span>apple<span class="op">-</span><span class="kw">darwin17.0</span> (<span class="dv">64</span><span class="op">-</span>bit)</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">Running under<span class="op">:</span><span class="st"> </span>macOS Catalina <span class="dv">10</span>.<span class="fl">15.7</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"></a>
<a class="sourceLine" id="cb26-6" data-line-number="6">Matrix products<span class="op">:</span><span class="st"> </span>default</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">BLAS<span class="op">:</span><span class="st">   </span><span class="er">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>R.framework<span class="op">/</span>Versions<span class="op">/</span><span class="fl">4.0</span><span class="op">/</span>Resources<span class="op">/</span>lib<span class="op">/</span>libRblas.dylib</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">LAPACK<span class="op">:</span><span class="st"> </span><span class="er">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>R.framework<span class="op">/</span>Versions<span class="op">/</span><span class="fl">4.0</span><span class="op">/</span>Resources<span class="op">/</span>lib<span class="op">/</span>libRlapack.dylib</a>
<a class="sourceLine" id="cb26-9" data-line-number="9"></a>
<a class="sourceLine" id="cb26-10" data-line-number="10">locale<span class="op">:</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11">[<span class="dv">1</span>] en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>C<span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"></a>
<a class="sourceLine" id="cb26-13" data-line-number="13">attached base packages<span class="op">:</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </a>
<a class="sourceLine" id="cb26-15" data-line-number="15"></a>
<a class="sourceLine" id="cb26-16" data-line-number="16">other attached packages<span class="op">:</span></a>
<a class="sourceLine" id="cb26-17" data-line-number="17">[<span class="dv">1</span>] kinship2_<span class="dv">1</span>.<span class="fl">8.5</span> quadprog_<span class="fl">1.5</span><span class="dv">-8</span> Matrix_<span class="fl">1.3</span><span class="dv">-2</span>  </a>
<a class="sourceLine" id="cb26-18" data-line-number="18"></a>
<a class="sourceLine" id="cb26-19" data-line-number="19">loaded via a <span class="kw">namespace</span> (and not attached)<span class="op">:</span></a>
<a class="sourceLine" id="cb26-20" data-line-number="20"><span class="st"> </span>[<span class="dv">1</span>] knitr_<span class="fl">1.31</span>        magrittr_<span class="dv">2</span>.<span class="fl">0.1</span>    lattice_<span class="fl">0.20</span><span class="dv">-41</span>   R6_<span class="dv">2</span>.<span class="fl">5.0</span>         </a>
<a class="sourceLine" id="cb26-21" data-line-number="21"> [<span class="dv">5</span>] ragg_<span class="dv">1</span>.<span class="fl">1.1</span>        rlang_<span class="dv">0</span>.<span class="fl">4.10</span>      fastmap_<span class="dv">1</span>.<span class="fl">1.0</span>     highr_<span class="fl">0.8</span>        </a>
<a class="sourceLine" id="cb26-22" data-line-number="22"> [<span class="dv">9</span>] stringr_<span class="dv">1</span>.<span class="fl">4.0</span>     tools_<span class="dv">4</span>.<span class="fl">0.3</span>       grid_<span class="dv">4</span>.<span class="fl">0.3</span>        xfun_<span class="fl">0.21</span>        </a>
<a class="sourceLine" id="cb26-23" data-line-number="23">[<span class="dv">13</span>] jquerylib_<span class="dv">0</span>.<span class="fl">1.3</span>   htmltools_<span class="dv">0</span>.<span class="dv">5</span>.<span class="fl">1.1</span> systemfonts_<span class="dv">1</span>.<span class="fl">0.1</span> yaml_<span class="dv">2</span>.<span class="fl">2.1</span>       </a>
<a class="sourceLine" id="cb26-24" data-line-number="24">[<span class="dv">17</span>] assertthat_<span class="dv">0</span>.<span class="fl">2.1</span>  digest_<span class="dv">0</span>.<span class="fl">6.27</span>     rprojroot_<span class="dv">2</span>.<span class="fl">0.2</span>   pkgdown_<span class="dv">1</span>.<span class="fl">6.1</span>    </a>
<a class="sourceLine" id="cb26-25" data-line-number="25">[<span class="dv">21</span>] crayon_<span class="dv">1</span>.<span class="fl">4.1</span>      textshaping_<span class="dv">0</span>.<span class="fl">3.1</span> formatR_<span class="fl">1.7</span>       sass_<span class="dv">0</span>.<span class="fl">3.1</span>       </a>
<a class="sourceLine" id="cb26-26" data-line-number="26">[<span class="dv">25</span>] fs_<span class="dv">1</span>.<span class="fl">5.0</span>          memoise_<span class="dv">2</span>.<span class="fl">0.0</span>     cachem_<span class="dv">1</span>.<span class="fl">0.4</span>      evaluate_<span class="fl">0.14</span>    </a>
<a class="sourceLine" id="cb26-27" data-line-number="27">[<span class="dv">29</span>] rmarkdown_<span class="fl">2.7</span>     stringi_<span class="dv">1</span>.<span class="fl">5.3</span>     compiler_<span class="dv">4</span>.<span class="fl">0.3</span>    bslib_<span class="dv">0</span>.<span class="fl">2.4</span>      </a>
<a class="sourceLine" id="cb26-28" data-line-number="28">[<span class="dv">33</span>] desc_<span class="dv">1</span>.<span class="fl">2.0</span>        jsonlite_<span class="dv">1</span>.<span class="fl">7.2</span>   </a></code></pre></div>

<p>\end{document}</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
